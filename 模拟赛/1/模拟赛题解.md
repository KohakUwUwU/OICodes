# A

维护道路$$0/1$$线段树，每个节点信息有当前区间是否全为$1$ $$link$$

维护节点线段树，每个节点信息维护最后一次被修复的时间

1. 维护$$link$$，单点修改$$0/1$$和节点线段树，$$O(logn)$$
2. 查询链上$link$是否为$1$，链查询，$$O(log^2n)$$
3. 查询$lca$，用$0/1$线段树，$$O(logn)$$
4. 先查连通性，$$O(log^2n)$$，若联通，查询链上最后一次被修复时间，$$O(log^2n)$$

信息

  a. 单点修改$0/1$线段树，$$O(logn)$$

  b. 进行一大堆单点修改，均摊复杂度$$O(logn)$$

总时间复杂度$$O(\sum q*log^2n)$$

