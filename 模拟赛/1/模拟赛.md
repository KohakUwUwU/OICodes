# A    Bang Dream!



# B    细胞神曲



# **C	幻想乡**

**时间限制：10s**

**内存限制：1GB**

## 题目大意



​	    幻想乡中每天都会有妖精在路边使用符卡进行决斗，每天决斗过后道路便会被摧毁，**博麗霊夢**需要派**霧雨魔理沙**去修缮道路。但是由于妖精们摧毁道路过于频繁，**魔理沙**会不高兴，她也想加入打斗。于是她会在妖精战斗的时候顺便摧毁道路所连接的村庄以泄愤。当**灵梦**发现**魔理沙**干了坏事之后，怒气值便会上升，上升的值为道路两侧能够到达的村庄的总数的乘积。当怒气值积累到一定程度，**灵梦**会将**魔理沙**和妖精们一起关禁闭，关禁闭的天数与这是第几次被关禁闭的数值相等。当关禁闭期间，就算将来几天会有决斗安排，也不会进行，但这并不影响**灵梦**大人问问题和提出要求。由于事务繁多，**灵梦**没有时间管教调皮的**魔理沙**，便派出了**八云紫**来找到聪明的你——**帕秋莉**。你要帮助繁忙的**灵梦**解决一下几个问题：

1. ​    $$1\ \ d\ \ u\ \ v$$  在第 $$d$$ 天，帮助她修缮村庄 $$u$$ 到村庄 $$v$$ 的道路

2. ​    $$2\ \ d\ \ u\ \ v$$  在第 $$d$$ 天，回答此时村庄 $$u$$ 到村庄 $$v$$ 的距离（经过边数），若不能到达，输出 $$-1$$ 

3. ​    

4. ​    $$4\ \ d\ \ u\ \ v$$  在第 $$d$$ 天，回答村庄 $$u$$ 与村庄 $$v$$ 最后一次能够互相到达是什么时候

   

   同时，**射命丸文**会告诉你以下信息：

1. ​    $$a\ \ d\ \ i$$  在第 $$d$$ 天，编号为 $$ i $$ 的道路被妖怪们摧毁了

2. ​    $$b\ \ d\ \ i$$  在第 $$d$$ 天，调皮的**魔理沙**在妖精摧毁编号为 $$i$$ 的道路时把两侧的村庄也摧毁了（村庄本身其实没有消失，但是村庄所连接的道路均不能通过，即摧毁一个村庄相当于摧毁一个村庄连接的所有道路）



另外保证以下几个条件：

​	a.    保证在整个过程中不会修缮本来不存在的边

​	b.    为了保证国泰民安，保证一个村庄被摧毁次数不超过村庄连接道路的个数

​	c.    保证整个幻想乡的村庄都能够互相到达



## 输入格式



第一行输入两个数 $$T,n,q$$ ，代表有 $$T$$ 个数据组数， $$n$$ 个村庄， $$q$$ 个问题或信息。

接下来 $$n-1$$ 行，每行输入两个数 $$u,v$$ ，代表村庄 $$u$$ 与村庄 $$v$$ 之间有一条道路。

接下来 $$q$$ 行，每行输入一个问题或者信息，格式见题面。

保证输入合法。



## 输出格式 



对于每个问题 $$2$$ 和进问题 $$3$$ 和问题 $$4$$ 行回答，每行一个答案，按照幻想乡内时间先后回答答案。若同一天有多个问题，当天按照输入问题时的先后回答答案。



## 样例



**样例输入1**

1 0



**样例输出**



大样例请见下发文件 $$sample.zip$$ 。



## 数据范围



对于所有测试点，$1<=T<=10$，$1<=n<=5*10^6$，$1<=\sum q<=5*10^6$，$1<=q<=1*10^6$。

| 测试点编号 | $T$  |   $n$    |   $q$    | 特殊性质 |
| :--------: | :--: | :------: | :------: | :------: |
|   $1-2$    | $1$  |  $2000$  |  $2000$  |    无    |
|   $3-5$    | $2$  |    无    |  $2000$  |   $A$    |
|   $6-8$    | $3$  |    无    |  $2000$  |    无    |
|   $9-10$   | $4$  | $1*10^6$ |    无    |   $A$    |
|  $11-12$   | $8$  | $1*10^6$ | $1*10^6$ |   $B$    |
|  $13-20$   |  无  |    无    |    无    |    无    |

特殊性质$A$：保证两个村庄最长距离不会小于 $n-1$。

特殊性质$B$：保证数据随机。



# D1    舞神之路



# D2    KOP2022